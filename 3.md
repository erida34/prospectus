# Глава 3. Рабочие станции

## Основные задачи обслуживания рабочих станций
1. **Первоначальная установка системного ПО и приложений**
2. **Обновление системного ПО и приложений**
3. **Настройка сетевых параметров**

## Жизненный цикл рабочей станции
1. **Новое состояние**: Совершенно новая машина.
2. **Чистое состояние**: Машина с установленной, но не настроенной ОС.
3. **Сконфигурированное состояние**: Система настроена и функционирует.
4. **Неизвестное состояние**: Неправильно сконфигурированная или устаревшая система.
5. **Отключенное состояние**: Машина списана и отключена.

## Процессы жизненного цикла
- **Сборка и инициализация**: Установка и настройка ОС.
- **Энтропия**: Деградация системы.
- **Обновления**: Патчи и пакеты обновления.
- **Восстановление**: Переустановка системы.
- **Списание**: Удаление машины из эксплуатации.

## Важные аспекты
- **Автоматизация**: Упрощает управление и обновление систем.
- **Централизованное управление**: Облегчает внесение изменений в сетевые параметры.
- **Планирование и ресурсы**: Необходимы для эффективного управления жизненным циклом.
- **Архитектурные решения**: Влияют на целостность ОС и скорость деградации.
- **Баланс прав пользователей**: Влияет на скорость разрушения ОС.

## Платформы
- **Платформа**: Комбинация поставщика оборудования и ОС.
- **Примеры**: ПК с AMD Athlon под Windows Vista, Mac с PPC под OS X 10.4, и т.д.
- **Разные платформы**: Могут быть разные версии одной ОС с различными требованиями поддержки.


# 3.1. Основы

## Критически важные аспекты обслуживания рабочих станций
1. **Первоначальная установка системного ПО и приложений**
2. **Обновление системного ПО и приложений**
3. **Настройка сетевых параметров**

## Автоматизация
- **Необходимость**: Для минимальных затрат на управление сетью.
- **Малые сети**: Полная автоматизация может не требоваться, но важно не пропустить этап расширения.

## Привилегированные объекты
- **Определение**: Платформы, получающие полноценную поддержку.
- **Поддержка**: Обучение администраторов, документация для пользователей, автоматизация установки, обновления и конфигурирования.
- **Остальные платформы**: Минимальная поддержка (IP-адреса, безопасность).

## Причины для привилегированного статуса
- **Запросы пользователей**
- **Инициатива администраторов**
- **Проблемы с самостоятельной установкой пользователей**
- **Безопасность**

## Вложения и ресурсы
- **Необходимость**: Утверждение руководством.
- **Окупаемость**: За счет качественного обслуживания.
- **Сложности**: Иногда требуется создание новых систем или программных надстроек.

## Взаимодействие с поставщиками
- **Вопросы**: Возможность автоматизации новой продукции.
- **Отклонение предложений**: Если поставщики не понимают проблем внедрения.
- **Тенденция**: Поставщики осознают важность быстрого развертывания.

# 3.1.1. Установка ОС

## Системы автоматической установки
- **Solaris**: JumpStart
- **RedHat Linux**: KickStart
- **SGI IRIX**: RoboInst
- **HP-UX**: Ignite-UX
- **Microsoft Windows**: Служба удаленной установки (Remote Installation Service)

## Преимущества автоматизации
- **Экономия времени и денег**: Замена ручных процессов автоматическими.
- **Устранение ошибок**: Снижение вероятности ошибок при ручной установке.
- **Однородность**: Обеспечение одинаковой конфигурации на всех машинах.

## Скрытые затраты
- **Ошибки**: Проблемы могут скрываться месяцами, что усложняет их диагностику.
- **Неоднородность**: Ручная установка не гарантирует одинаковой конфигурации.

## Пример: Автоматизация установки Windows NT
- **Проблемы ручной установки**: Системные администраторы тратили около четверти времени на решение проблем.
- **Решение**: Автоматизация с помощью системы AutoLoad.
- **Результаты**: Упрощение процесса установки, снижение ошибок, улучшение жизни пользователей и администраторов.

# 3.1.1.1. Удостоверьтесь, что ваша автоматизированная система действительно автоматизирована

## Важность полной автоматизации
- **Усилия окупятся**: Настройка автоматизированной системы требует усилий, но они окупятся.
- **Полная автоматизация**: Установка должна быть полностью автоматизирована, без необходимости ручного вмешательства.

## Пример: JumpStart в Solaris
- **Уведомление по электронной почте**: Автоматическое уведомление о завершении установки.
- **Полная автоматизация**: Вся установка проходит без ручного вмешательства, что позволяет администраторам эффективно управлять временем.

## Лучшие системы установки
- **Взаимодействие в начале**: Все взаимодействие с человеком происходит в начале, затем процесс полностью автоматизирован.
- **Без ручного вмешательства**: Система должна работать автономно, без необходимости возвращения администратора.

## Пример: JumpStart в Solaris
- **Шаблоны**: Использование заранее настроенных шаблонов.
- **Процесс установки**: Техник вводит команду `boot net – install` и уходит, машина готова к работе через 30–90 минут.

## Устранение ручных операций
- **Интеграция всех этапов**: Важно интегрировать все этапы в автоматизированный процесс.
- **Тестирование**: Проверьте систему с помощью человека, незнакомого с вашей работой, чтобы убедиться в полной автоматизации.

# 3.1.1.2. Частично автоматизированная установка

## Преимущества частичной автоматизации
- **Лучше, чем полное отсутствие**: Частичная автоматизация улучшает процесс установки.
- **Временные меры**: Необходимы для этапов, которые еще не автоматизированы.

## Оправдание отсутствия полной автоматизации
- **Малое количество платформ**
- **Высокие затраты на автоматизацию**
- **Ограничения поставщика**

## Документирование процесса
- **Важность**: Позволяет воспроизводить процесс в точности.
- **Методы**: Записи при создании первой системы, скрипты для копирования файлов, архивы tar или zip.

## Пример: AutoLoad в Windows NT 4.0
- **Проблема**: Не поддерживалась автоматическая установка драйверов сторонних поставщиков.
- **Решение**: Сообщение пользователю о временной недоступности звука и указание времени визита администратора.

## Временные меры
- **Создание заявки**: Необходимо отметить необходимость в постоянном решении, чтобы временные меры не стали постоянными.

# 3.1.1.3. Клонирование и другие методы

## Клонирование жестких дисков
- **Процесс**: Создание "золотого узла" и копирование на новые машины.
- **Методы**: Копирование на компакт-диск, ленточный накопитель или файловый сервер.

## Преимущества автоматизированного процесса
- **Гибкость**: Не требует множества мастер-образов.
- **Управление изменениями**: Легче вносить изменения.
- **Экономия ресурсов**: Меньше резервных машин и усилий.

## Проблемы с клонированием
- **Поддержка ОС**: Некоторые ОС не поддерживают клонирование (например, Windows NT и SID).

## Комбинированный подход
- **Клонирование и автоматизация**: Клонирование для минимальной установки ОС, автоматизация для приложений и патчей.

## Пример: PARIS для SunOS 4.x
- **Создание собственной системы**: Виктор Духовны создал PARIS для автоматической удаленной установки SunOS 4.x.
- **Преимущества**: Удаленное управление и экономия времени администраторов.

## Альтернативные решения
- **Скрипты**: Использование скриптов для завершения установки после загрузки ОС с компакт-диска.
- **Инновации**: Разработка собственных систем установки, если поставщики не предоставляют необходимые инструменты.


# 3.1.1.4. Стоит ли доверять установкам от поставщиков

## Причины для переустановки ОС
- **Установка приложений**: Легче автоматизировать установку с нуля, чем настраивать предустановленную ОС.
- **Известное состояние**: Переустановка дает известное состояние каждой машины.
- **Различия в конфигурации**: Предустановленная ОС может иметь отклонения от стандартной конфигурации.

## Проблемы с предустановленной ОС
- **Поддержка двух платформ**: Различия между предустановленной и установленной вами ОС.
- **Аварийные ситуации**: Зависимость от поставщика для восстановления системы.

## История про ОС с обязательной предустановкой
- **Проблема**: Невозможность переустановки ОС без помощи поставщика.
- **Решение**: Держать запасной жесткий диск и инструкции по восстановлению системы.

## Проверка диска для восстановления
- **Дополнения и драйверы**: Убедитесь, что все необходимые компоненты включены.
- **Ноутбуки**: Особое внимание драйверам критически важных устройств.

## Предустановка с вашим образом диска
- **Преимущества**: Избавление от необходимости самостоятельной установки и знание того, что установлено.
- **Обязанности**: Обновление мастер-образа по мере появления новых устройств и моделей.

# 3.1.1.5. Контрольные списки при установке

## Преимущества контрольных списков
- **Согласованность процесса**: Убедитесь, что техники не пропустят ни одного этапа.
- **Обучение**: Основа для обучения новых системных администраторов или подготовки служащих.

## Использование контрольных списков
- **Ручная установка**: Очевидная польза при полностью ручной установке.
- **Автоматизированная установка**: Полезны даже при полной автоматизации для физических действий (например, запуск процесса, проверка мыши и монитора).

## Примеры задач в контрольном списке
- **Физические действия**: Запуск процесса установки, проверка работы мыши и монитора.
- **Инвентаризация**: Обновление инвентаризационных описей.
- **Заказы**: Составление заказов на сетевые кабели.
- **Проверка**: Проверка через неделю на наличие проблем или вопросов у пользователей.

# 3.1.2. Обновление системного ПО и приложений

## Необходимость обновлений
- **Исправление ошибок и брешей**: Обновления необходимы для исправления ошибок и уязвимостей.
- **Новые приложения**: Установка новых приложений и обновление существующих.

## Автоматизация обновлений
- **Системы автоматизации**:
  - **Solaris**: AutoPatch
  - **Microsoft Windows**: SMS
  - **Red Hat Linux**: RPM
  - **SGI IRIX**: RoboInst
  - **HP-UX**: Software Distributor (SD-UX)
  - **Кросс-платформенные системы**

## Функции систем обновления
- **Универсальность**: Установка новых приложений, обновление существующих и установка патчей ОС.
- **Незначительные изменения**: Упаковка небольших изменений конфигурации в патчи.
- **Постустановочные скрипты**: Включение скриптов для выполнения изменений после установки.

## Пример: Установка новой системы печати
- **Первая компания**:
  - **Проблема**: Отсутствие автоматизированной системы обновления.
  - **Результат**: Высокие затраты на ручную установку клиентского ПО.
- **Вторая компания**:
  - **Преимущество**: Использование документированной системы обновления.
  - **Результат**: Быстрая и эффективная установка клиентского ПО, экономия средств.

## Выводы
- **Экономия**: Вложение в автоматизацию обновлений экономит время и деньги в долгосрочной перспективе.
- **Предусмотрительность**: Важно заранее внедрять системы автоматизации для будущих обновлений.

# 3.1.2.1. Процесс обновления отличается от установки

## Основные различия
- **Состояние узла**: Обновление проводится на работающих машинах, первичная установка — на чистых.
- **Место установки**: Обновление в офисе, первичная установка может быть в лаборатории.
- **Физический доступ**: При обновлении не требуется физический доступ к машине.
- **Использование узла**: Обновление должно проходить без прерывания работы пользователя.
- **Состояние системы**: Узел может не находиться в "известном состоянии", что требует более точной автоматизации.
- **Пользование в процессе**: Некоторые обновления могут требовать временного отключения пользователя.
- **Отсутствие узла**: Ноутбуки могут быть отключены от сети, система должна отслеживать их появление.
- **Мультисистемная загрузка**: Система обновления должна учитывать наличие нескольких ОС на одном узле.

# 3.1.2.2. Одна, несколько, много

## Метод "одна, несколько, много"
1. **Одна**: Установите патч на одну машину (лучше свою) и исправьте ошибки.
2. **Несколько**: Установите патч на несколько машин системных администраторов и дружелюбных пользователей.
3. **Много**: Постепенно переходите к большим группам пользователей.

## Управление риском
- **Документирование**: Процесс должен быть хорошо документирован.
- **Повторяемость**: Обеспечьте повторяемость процесса и улучшайте его после каждого использования.

## Советы по обновлению
- **Согласование**: Создайте строго определенное обновление и представьте его на утверждение.
- **План оповещения**: Составьте план оповещения для пользователей.
- **Критерии успешности**: Определите критерии успешности для каждого этапа.
- **Остановка процесса**: Разработайте способ для пользователей остановить процесс обновления в случае сбоя.

# 3.1.3. Конфигурирование сети

## Автоматизация обновления сетевых параметров
- **DHCP**: Наиболее распространенная система автоматизации.
- **Планирование**: Создание глобальной архитектуры DNS/DHCP требует основательного планирования и специальных знаний.

## Преимущества DHCP
- **Экономия времени**: DHCP упрощает изменение сетевых параметров (IP-адреса, маски подсети и т.д.).
- **Избежание ручного ввода**: Ручной ввод параметров может привести к значительным затратам времени при изменениях.

## Вложения в DHCP
- **Долгосрочная экономия**: Незначительные вложения в DHCP сделают будущие изменения практически бесплатными.
- **Качество выполнения**: DHCP должен быть настроен правильно для эффективного использования.

# 3.1.3.1. Используйте шаблоны, а не конфигурируйте каждый отдельный узел

## Преимущества использования шаблонов
- **Эффективность**: Изменение шаблона применяется ко всем узлам, что быстрее, чем изменять каждый узел вручную.
- **Снижение ошибок**: Генерация конфигурации программой уменьшает вероятность синтаксических ошибок.

## Применение шаблонов
- **Системы DHCP**: Используйте шаблоны для описания параметров узлов различных классов.
- **Автоматизация**: Изменение шаблона позволяет быстро внести изменения на множестве узлов.
- **Синтаксическая правильность**: Шаблоны обеспечивают правильность конфигурации.

# 3.1.3.2. Когда применять динамическую аренду адресов

## Преимущества динамической аренды
- **Удобство для администраторов и пользователей**: Облегчает управление и повышает удобство использования.
- **Эффективность**: Подходит для сетей с большим количеством узлов и ограниченным количеством IP-адресов.

## Примеры использования
- **Серверы удаленного доступа (RAS)**: Динамическое распределение адресов для множества узлов.
- **Временные узлы**: Лаборатории, комнаты настройки компьютеров, сети для ноутбуков посетителей.

## Преимущества статической аренды
- **Надежность**: Предотвращает проблемы с доступом к сети для критически важных узлов.
- **Удобство журналов**: Обеспечивает постоянство IP-адресов в файлах журнала.
- **Совместимость**: Предотвращает проблемы с программным обеспечением, требующим статические IP-адреса.

## Безопасность
- **IEEE 802.1x**: Стандарт управления доступом к сети для предотвращения несанкционированного подключения.
- **Аутентификация**: Коммутаторы Ethernet, поддерживающие 802.1x, требуют аутентификации для подключения к сети.

# 3.1.3.3. Использование DHCP в сетях общего пользования

## Примеры использования
- **Отели и общественные места**: Сети, где легко подключиться, но доступ ограничен веб-страницей авторизации.
- **Авторизация**: После авторизации (идентификация или платеж) предоставляется полный доступ.

## Преимущества
- **Удобство**: Решение plug-in-and-go для выделения пространства адресов.
- **Безопасность**: Проверка разрешений на использование ресурсов.

## Исторические решения
- **Регистрация узлов**: Системы позволяли незарегистрированным узлам регистрироваться от имени ответственного лица.

# 3.1.4. Старайтесь не использовать динамический DNS-сервер с DHCP

## Проблемы динамического DNS с DHCP
- **Усложнение системы**: Увеличивает сложность и риски для безопасности.
- **Несоответствие имен**: Имена узлов в DNS могут не соответствовать локальным именам узлов.
- **Безопасность**: Риск нарушения безопасности, если узлы могут определять свои имена.

## Преимущества статической аренды
- **Постоянство**: Узлы со статической арендой всегда имеют одно и то же имя в DNS.
- **Безопасность**: Централизованный контроль имен узлов предотвращает конфликты.

## Альтернативы динамическому DNS
- **Система регистрации и слежения**: Для отслеживания несанкционированного поведения узлов.
- **Ограничение распространения**: Использование динамического DNS только в определенных сетевых субдоменах.

## Рекомендации
- **Избегайте использования**: Динамический DNS с DHCP создает сложную и менее безопасную систему.
- **Ограничение рисков**: Используйте динамический DNS только в зонах с низкими требованиями к надежности.

# 3.1.4.1. Управление сроками аренды DHCP

## Управление сроками аренды
- **Распределение обновлений**: DHCP-клиенты обновляют параметры по истечении срока аренды.
- **Изменение срока аренды**: Уменьшение срока аренды перед изменениями ускоряет распространение обновлений.

## Пример: Изменение IP-адреса DNS-сервера
- **Проблема**: Изменение IP-адреса DNS-сервера требует времени на распространение.
- **Решение**: Временное перенаправление пользователей на другой DNS-сервер для тестирования и изменения настроек.

## Оптимальная продолжительность срока аренды
- **Философский вопрос**: Определение оптимальной продолжительности срока аренды зависит от конкретных условий.
- **Рекомендации**: Прочитать книги «The DHCP Handbook» и «DHCP: A Guide to Dynamic TCP/IP Network Configuration».

## Пример: Использование сети ноутбуков в Bell Labs
- **Короткий срок аренды**: В комнате UNIX используется пятиминутный срок аренды для ноутбуков.
- **Преимущества**: Быстрое освобождение адресов и адаптация к изменениям.


# 3.2. Тонкости

## Основные моменты
- **Технические основы**: Правильное выполнение задач влияет на все остальные действия.
- **Новые технологии**: Следите за новыми технологиями для автоматизации поддержки рабочих станций.

## 3.2.1. Полная уверенность в завершении
- **Автоматизация процесса**: Уверенность в процессе избавляет от беспокойства об ошибках.
- **Пример**: Кристоф Кальт использовал Solaris JumpStart для автоматизации установки без ошибок.

## 3.2.2. Вовлечение пользователей в процесс стандартизации
- **Участие пользователей**: Пользователи должны участвовать в процессе составления спецификаций и разработки.
- **Соглашение об уровне обслуживания**: Описание уровня обслуживания для каждого приложения.
- **Контролируемое внедрение**: Аналогично автоматизированному процессу обновления.

## Реальные сценарии
- **Контроль платформ**: Руководством или отделом системного администрирования.
- **Примеры**: Офис приема заказов по телефону с определенным набором приложений.
- **Открытая среда**: Стандартная платформа для персонального компьютера с необходимыми приложениями и утилитами.
- **Формальные процессы**: Для определенных групп разработчиков с описанным и одобренным набором инструментов.


# 3.2.3. Разнообразие стандартных конфигураций

## Преимущества и недостатки
- **Преимущества**: Разнообразие конфигураций может удовлетворить различные потребности пользователей.
- **Недостатки**: Увеличение количества конфигураций усложняет обслуживание.

## Управление конфигурациями
- **SCM (Software Configuration Management)**: Процесс управления стандартизированными конфигурациями для серверов и настольных компьютеров.
- **Серверы**: Разработка специальных конфигураций для установки серверов.
- **Обновление ОС**: Упрощение процесса обновления ОС с помощью стандартных конфигураций.

## Заключение
- **Основные процессы**:
  1. Автоматизация первичной установки ОС.
  2. Автоматизация обновления программного обеспечения.
  3. Централизованное управление конфигурацией сети с помощью DHCP.
- **Цель**: Эффективное управление жизненным циклом рабочих станций для улучшения пользовательского опыта и упрощения административных задач.