# Глава 4. Серверы

## Основные моменты
- **Надежность и бесперебойная работа**: Серверы поддерживают множество пользователей, поэтому их надежность критична.
- **Производительность и долговечность**: Серверы рассчитаны на более длительный срок службы и требуют дополнительных вложений для повышения производительности.

## 4.1. Основы
- **Оборудование**: Серверное оборудование отличается от настольных компьютеров и имеет другие возможности и экономическую модель.
- **Обслуживание**: Серверы часто поставляются с контрактами на обслуживание, системами резервного копирования и возможностью удаленного доступа.

## 4.1.1. Покупайте для серверов серверное оборудование
- **Расширяемость**: Больше пространства для жестких дисков, слотов для карт расширения и центральных процессоров.
- **Производительность ЦП**: Многопроцессорные системы с дополнительными возможностями, такими как упреждающая выборка данных и динамическое распределение ресурсов.
- **Высокопроизводительные системы ввода-вывода**: Использование высокоскоростных интерфейсов и подсистем.
- **Возможности модернизации**: Добавление или замена процессоров без значительных аппаратных изменений.
- **Монтирование в стойку**: Серверы должны быть сконструированы для установки в стойки, с учетом охлаждения и вентиляции.
- **Дополнения для надежности**: Дублированные источники питания, RAID, несколько сетевых карт и поддержка "горячей" замены.
- **Контракт на обслуживание**: Гарантийные сроки и замена запасных частей.
- **Альтернативные варианты управления**: Поддержка функций удаленного управления и встроенные датчики мониторинга.

## Заключение
- **Улучшение серверов**: Поставщики постоянно совершенствуют серверы для удовлетворения потребностей бизнеса, особенно в колокейшн-центрах.

# 4.1.2. Выбирайте поставщиков, известных надежностью продукции

## Основные моменты
- **Надежность продукции**: Выбирайте поставщиков, известных надежностью своей продукции.
- **Опыт поставщиков**: Опытные поставщики обеспечивают дополнительные возможности и лучшее обслуживание.
- **Ресурсы для общения**: SAGE и LOPSA для общения с другими системными администраторами.

## Однотипное и разнотипное оборудование
- **Однотипное оборудование**: Легче обслуживать, меньше времени на подготовку, один набор запасных частей.
- **Разнотипное оборудование**: Меньше зависимости от одного поставщика, конкуренция между поставщиками.

# 4.1.3. Реальные расходы на серверное оборудование

## Цена компьютера
- **Домашняя серия**: Низкая начальная цена, дополнения и расширения дороже.
- **Бизнес-серия**: Выше начальная цена, дольше не устаревает, меньше новейших компонентов.
- **Серверная серия**: Ориентирована на лучшее соотношение себестоимости и производительности, дороже в производстве.

## Причины высокой цены серверов
- **Корпус**: Удобнее для обслуживания, дороже в производстве.
- **Ограничения на расположение**: Доступ к отсекам только с определенной стороны.
- **Экономия средств**: Сокращение времени на ремонт и упрощение обслуживания.

## Сравнение серверов и настольных компьютеров
- **Разные объекты**: Серверы и настольные компьютеры имеют разные модели ценообразования.
- **Оправданные расходы**: Серверы обслуживают множество пользователей, что оправдывает их стоимость.
- **Простой сервера**: Дороже простоя настольного компьютера, дополнительное оборудование легко окупается.

## Аргумент против дорогого сервера
- **Излишняя производительность**: Покупка сервера "с запасом" может отсрочить сложную модернизацию в будущем.

# 4.1.4. Контракты на обслуживание и запасные компоненты

## Основные моменты
- **Ремонт серверов**: Все серверы рано или поздно ломаются, поэтому важно заранее продумать процесс ремонта.
- **Виды контрактов на обслуживание**: Различные уровни обслуживания, включая сроки реагирования и предоставление запасных компонентов.

## Сценарии выбора контракта
1. **Не критически важный сервер**: Контракт с длительным сроком реагирования или без контракта.
2. **Большая группа идентичных серверов**: Приобретение комплекта запасных компонентов и недорогой контракт на обслуживание.
3. **Постепенная модернизация**: Стандартизация срока обеспечения запасными компонентами для устаревших моделей.
4. **Важные узлы**: Хранение запасных компонентов, которые чаще всего выходят из строя, и контракт на обслуживание в тот же день.
5. **Большое количество моделей от одного поставщика**: Контракт на обслуживание с выделением техника для работы в сети компании.
6. **Критически важный узел**: Контракт на обслуживание с предоставлением дублирующей машины.

## Управление запасными компонентами
- **Компромисс между хранением и контрактом**: Определите, что выгоднее — хранить запасные компоненты или заключить контракт на обслуживание.
- **Перекрестная доставка**: Поставщики должны предоставлять замену немедленно и ожидать возврата неисправного компонента в течение определенного срока.
- **Избегайте поставщиков без перекрестной доставки**: Такие поставщики недостаточно серьезно относятся к понятию "сервер".

## Дополнительные рекомендации
- **Регулярный пересмотр контракта**: Пересматривайте контракт ежегодно или ежеквартально для добавления новых серверов и исключения устаревших.
- **Инвентаризация**: Используйте систему инвентаризации для отслеживания оборудования и перекрестного пересмотра контракта.
- **Ответственность за закупки**: Назначьте ответственного за добавление новых машин в контракт и определение уровня обслуживания.
- **Гарантийные условия**: Убедитесь, что поставщик может включить машины в контракт сразу, но не брать плату за обслуживание в течение первых 12 месяцев.


# 4.1.5. Обеспечение целостности данных

## Основные моменты
- **Критически важные данные**: Серверы хранят важные данные и уникальные конфигурации, которые должны быть защищены.
- **Резервное копирование**: Клиентские рабочие станции обычно не требуют резервного копирования, так как их данные хранятся на серверах.
- **UNIX-системы**: Меньше подвержены локальным изменениям, защищены от записи на локальном диске.

## 4.1.6. Размещение серверов в вычислительном центре

## Основные моменты
- **Условия размещения**: Серверы должны размещаться в условиях с надежным энергоснабжением, противопожарной защитой, сетью, охлаждением и физической безопасностью.
- **Планирование места**: Зарезервируйте физическое место для сервера при его приобретении.
- **Сборка и установка**: Устанавливайте сервер в стойку непосредственно после сборки.
- **Машинный зал**: Обеспечьте физическую безопасность, источник бесперебойного питания и достаточное охлаждение.

## 4.1.7. Конфигурация клиент-серверной ОС

## Основные моменты
- **Разные ОС**: Серверы не обязательно должны работать под управлением той же ОС, что и клиенты.
- **Протоколы**: Клиенты и серверы должны использовать одинаковые протоколы.
- **Специализированные устройства**: Мини-ОС с программным обеспечением, достаточным для выполнения единственной функции.
- **UNIX-сети**: Установка одинаковой ОС на клиентах и серверах с различными конфигурациями для разных задач.
- **Ориентированность на перспективу**: Серверная ОС может быть настроена для большего количества процессов, псевдотерминалов, буферов и других параметров.

# 4.1.8. Обеспечьте удаленный доступ через консоль

## Основные моменты
- **Удаленное обслуживание**: Необходимость удаленного доступа для серверов.
- **Переключатель КВМ**: Устройство, позволяющее нескольким машинам использовать одну клавиатуру, видеоэкран и мышь.
- **IP-КВМ**: Удаленный доступ к консольному серверу КВМ через сеть.
- **Последовательные консоли**: Использование последовательных портов для подключения к терминалам.
- **Удаленное управление**: Возможность удаленного управления машиной через карты расширения или сторонние решения.
- **Безопасность**: Необходимость продуманных систем аутентификации и конфиденциальности для удаленного доступа.

## Преимущества удаленного доступа
- **Экономия места**: Освобождение пространства в машинном зале.
- **Удобство**: Возможность удаленного управления сервером без необходимости физического присутствия.
- **Безопасность**: Удаленный доступ позволяет системным администраторам работать в более комфортных условиях.

## Ограничения удаленного доступа
- **Физическое присутствие**: Некоторые задачи требуют физического присутствия для выполнения.
- **Безопасность**: Необходимость обеспечения безопасности удаленного доступа.

## Рекомендации
- **Проверка возможностей**: При покупке сервера убедитесь в наличии возможности удаленного консольного доступа.
- **Безопасность**: Используйте шифрованные каналы и системы аутентификации для удаленного доступа.
- **Дополнительная информация**: Подробнее об удаленном доступе в разделе 6.1.10.

# 4.1.9. Зеркалирование загрузочных дисков

## Основные моменты
- **Зеркалирование дисков**: Создание зеркального диска для каждого сервера для ускорения восстановления.
- **RAID**: Метод зеркалирования, позволяющий автоматически переключаться на работоспособный диск при отказе основного диска.
- **Производительность**: Зеркалирование улучшает производительность чтения, но замедляет запись.
- **Безопасность**: Зеркалирование защищает от сбоев оборудования, но не от программных или пользовательских ошибок.

## Преимущества зеркалирования
- **Быстрое восстановление**: Сбой жесткого диска становится событием, которое можно контролировать.
- **Контроль простоя**: Планирование простоя в соответствии с потребностями компании.

## Пример из практики
- **Проблема**: Программная ошибка вызвала долгий простой в работе, который обошелся компании очень дорого.
- **Урок**: Зеркалирование очень полезно, но нельзя недооценивать грамотные утилиты для резервного копирования, позволяющие вернуться к исправному известному состоянию.

# 4.2.1. Повышение надежности и удобства обслуживания

## 4.2.1.1. Одноцелевые серверы

### Основные моменты
- **Одноцелевые устройства**: Устройства, созданные для выполнения одной конкретной задачи.
- **Преимущества**: Высокая надежность и производительность, упрощение управления и поддержки.
- **Примеры**: Файловые серверы, веб-серверы, серверы электронной почты, DNS-серверы.

### Преимущества одноцелевых серверов
- **Специализация**: Устройства, предназначенные для выполнения одной задачи, часто выполняют её лучше, чем универсальные устройства.
- **Экономия времени**: Одноцелевые устройства позволяют системным администраторам сосредоточиться на других задачах.
- **Поддержка**: Уменьшение количества систем, которые нужно устанавливать и поддерживать.
- **Качество**: Организации могут получить качественно настроенные системы без необходимости нанимать опытных специалистов.
- **Уникальные возможности**: Одноцелевые устройства часто имеют уникальные функции, которые недоступны на универсальных устройствах.

### Примеры
- **Файловые серверы**: Устройства, предназначенные для хранения и управления файлами.
- **Веб-серверы**: Устройства, предназначенные для обслуживания веб-страниц.
- **Серверы электронной почты**: Устройства, предназначенные для управления электронной почтой.
- **DNS-серверы**: Устройства, предназначенные для преобразования доменных имен в IP-адреса.

### Заключение
- **Эффективность**: Одноцелевые серверы повышают надежность и удобство обслуживания, упрощая управление и поддержку.
- **Конкуренция**: Поставщики добавляют новые возможности, повышают производительность и улучшают надежность одноцелевых устройств.

# 4.2.1. Повышение надежности и удобства обслуживания

## 4.2.1.2. Резервные блоки питания

### Основные моменты
- **Резервные блоки питания**: Важны для обеспечения надежности серверов.
- **Избыточность**: Система должна оставаться работоспособной при отказе одного блока питания.
- **Отдельные кабели питания**: Каждый блок питания должен иметь отдельный кабель питания для повышения надежности.
- **Разные источники питания**: Подключение каждого блока питания к разным источникам питания (например, UPS) для повышения надежности.

### Преимущества отдельных кабелей питания
- **Избежание проблем**: Отдельные кабели питания помогают избежать проблем, связанных с случайным отключением кабеля.
- **Переключение источников**: Возможность переключения на другой источник питания без простоя системы.

### Пример из практики
- **Проблема**: Необходимость отключения UPS в машинном зале.
- **Решение**: Использование резервных блоков питания с отдельными кабелями для обеспечения непрерывной работы маршрутизатора.

## 4.2.1.3. Полная избыточность, или n + 1

### Основные моменты
- **Избыточность n + 1**: Система продолжает функционировать после отказа одного компонента.
- **Полная избыточность**: Два полных набора оборудования объединены в отказоустойчивую конфигурацию.
- **Распределение нагрузки**: Обе системы полноценно функционируют и распределяют нагрузку между собой.

### Преимущества избыточности n + 1
- **Экономичность**: n + 1 часто предпочтительнее полной избыточности из-за экономичности.
- **Применение**: Избыточность n + 1 обычно используется для серверных подсистем, а не для всех видов компонентов.

### Пример
- **Автомобиль**: Полная избыточность в автомобиле с дополнительными покрышками, но без резервного двигателя.

### Заключение
- **Проверка**: Всегда проверяйте, не пытается ли поставщик продать систему с избыточностью n + 1, где резервными являются только некоторые части системы.

# 4.2.1. Повышение надежности и удобства обслуживания

## 4.2.1.5. Раздельные сети для административных функций

### Основные моменты
- **Раздельные сети**: Создание отдельных сетей для административных функций, таких как резервное копирование и мониторинг.
- **Преимущества**: Высокая пропускная способность и надежность, отсутствие влияния на основную сеть.
- **Простота реализации**: Использование дополнительных сетевых интерфейсов на серверах.

### Преимущества раздельных сетей
- **Высокая пропускная способность**: Резервное копирование и мониторинг требуют высокой пропускной способности, которая не будет мешать пользователям основной сети.
- **Надежность**: Отдельная сеть для административных функций не будет подвержена простоям основной сети.
- **Доступность**: Системные администраторы могут получить доступ к машине даже во время простоя основной сети.

### Примеры использования
- **Резервное копирование**: Высокая пропускная способность и надежность для резервного копирования.
- **Мониторинг**: Отдельная сеть для мониторинга, не подверженная простоям основной сети.

### Заключение
- **Специфическая проблема**: Решение специфической проблемы с помощью раздельных сетей для административных функций.
- **Простота и надежность**: Простота реализации и повышенная надежность административных функций.

# 4.2.2. Альтернатива: множество недорогих серверов

## Основные моменты
- **Экономичность**: Использование множества недорогих серверов может быть экономичнее, чем использование одного дорогого сервера.
- **Масштабируемость**: Большое количество недорогих серверов можно использовать для масштабирования и распределения нагрузки.
- **Надежность**: Использование множества серверов может повысить надежность за счет распределения нагрузки и резервирования.

## Преимущества множества недорогих серверов
- **Экономия затрат**: Снижение затрат на оборудование за счет использования серийных компонентов.
- **Масштабируемость**: Возможность легко масштабировать систему путем добавления новых серверов.
- **Надежность**: Повышение надежности за счет распределения нагрузки и резервирования.

## Примеры использования
- **Веб-серверы**: Использование множества недорогих серверов для обслуживания веб-трафика.
- **Кластерные системы**: Использование кластерных систем для распределения нагрузки и повышения надежности.

## Пример из практики
- **Проблема**: Необходимость обслуживания большого количества запросов.
- **Решение**: Использование множества недорогих серверов для распределения нагрузки и повышения надежности.

## Заключение
- **Эффективность**: Множество недорогих серверов может быть более эффективным решением для масштабирования и повышения надежности.
- **Управление**: Важно организовать управление и мониторинг множества серверов для обеспечения их эффективной работы.

# 4.3. Заключение

## Основные моменты
- **Экономические факторы**: Серверы играют критическую роль в деятельности множества пользователей, поэтому экономические факторы имеют большое значение при их покупке.
- **Обслуживание и восстановление**: Серверы могут давать сбои, поэтому необходимо заключить контракт на обслуживание или иметь план восстановления, а также предусмотреть возможность резервного копирования и восстановления данных.
- **Машинные залы**: Серверы должны размещаться в специальных машинных залах, обеспечивающих условия для надежной работы.
- **Одноцелевые серверы**: Одноцелевые серверы предлагают высококачественные решения, разработанные с учетом многолетнего опыта.
- **Резервные блоки питания**: Важны для обеспечения надежности серверов.
- **Горячая замена**: Возможность замены компонентов во время работы системы.
- **Раздельные сети**: Создание отдельных сетей для административных функций.
- **Множество недорогих серверов**: Экономичное решение для масштабирования и распределения нагрузки.

## Рекомендации
- **Планирование**: Заранее планируйте электросеть, пропускную способность сети и систему охлаждения.
- **Удаленное администрирование**: Обеспечьте возможность удаленного администрирования для системных администраторов.
- **Надежность**: Используйте дополнительные системы и компоненты для повышения надежности серверов.
- **Обслуживание**: Заключите контракт на обслуживание или имейте план восстановления для серверов.
- **Резервное копирование**: Обеспечьте возможность резервного копирования и восстановления данных.

## Заключение
- **Основы**: Разобравшись с основами, можно перейти к более сложным методам повышения надежности и удобства обслуживания серверов.
- **Практика**: Применение рекомендаций на практике поможет повысить надежность и удобство обслуживания серверов.