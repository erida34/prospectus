# Глава 10. Аварийное восстановление и целостность данных

## План аварийного восстановления
- Определяет нештатные ситуации и план реакции.
- Включает смягчение последствий и быстрое восстановление ключевых служб.
- Должен быть на всех сайтах.
- Учитывает правовые и финансовые обязательства компании.

## 10.1. Основы
- Определение требований: нештатные ситуации, их вероятность, стоимость и время восстановления.
- Получение средств и поиск способов выполнения требований.

### 10.1.1. Определение нештатной ситуации
- Катастрофическое событие, вызывающее сильный сбой.
- Примеры: стихийные бедствия, повреждение кабелей.
- Влияет на возможность компании вести бизнес.

### Пример недостатка планирования
- Пожар в здании компании.
- Сотрудники выбрасывали аппаратуру из окна.
- Недостаток планирования привел к риску для жизни сотрудников.

## 10.1.2. Анализ рисков
- Первый шаг в планировании аварийного восстановления.
- Можно привлечь сторонних консультантов.
- Определение нештатных ситуаций и их вероятности.
- Оценка возможных издержек и бюджета на предупреждение рисков.
- Формула для определения бюджета:
  $
  \text{Бюджет} = \frac{\text{Возможные издержки} \times \text{Вероятность}}{\text{Возможные издержки после предупреждения}}
  $
- Примеры: наводнение, землетрясение, сбой маршрутизатора.

## 10.1.3. Правовые обязательства
- Учитывать правовые обязательства перед поставщиками, клиентами и акционерами.
- Соблюдение строительных норм и правил техники безопасности.
- Юридический отдел должен разъяснить обязательства.
- Перевод обязательств в требования для плана аварийного восстановления.

## 10.1.4. Ограничение ущерба
- Снижение издержек в результате нештатных ситуаций.
- Некоторые меры могут быть бесплатными или с небольшими затратами.
- Примеры: размещение структур на высоте, использование прочных стоек, громоотводы.
- Дорогие меры: подземные бункеры, сейсмоустойчивые механизмы.
- Системы пожаротушения и отслеживание влажности.
- Обеспечение бесперебойного питания и использование генераторов.

## 10.1.5. Подготовка
- Подготовка к нештатным ситуациям для быстрого восстановления основных систем.
- Восстановление служб может потребовать перестройки данных и служб на новом оборудовании.
- Определение источника замены оборудования и альтернативного помещения.
- Убедитесь, что поставщик оборудования знает, куда его отправлять в случае аварии.
- Учитывайте время замены оборудования при подсчете общих затрат времени.
- Восстановление системы требует резервных копий данных вне сайта.
- Проверка времени получения резервных копий от сторонней компании.
- Безопасное хранение важных документов в специализированных хранилищах.
- Обеспечение электропитания, телефонного и сетевого соединения.
- Назначение резервного местоположения офиса для выполнения важнейших функций.

### Пример хорошей подготовки
- Центр обработки вызовов в Калифорнии быстро восстановил работу после землетрясения.
- Использование внешних источников электропитания и телефонных служб.
- Перемещение центра обработки вызовов на улицу с использованием палаток и складной мебели.

## 10.1.6. Целостность данных
- Обеспечение неизменности данных под действием внешних источников.
- Данные могут быть повреждены злоумышленно или случайно.
- Целостность данных обеспечивается ежедневным резервным копированием и архивацией.
- Проверка данных по неизменяемой контрольной сумме.
- Проверка баз данных на неожиданно большие изменения или удаления.
- Аварийное восстановление должно обеспечивать целостность данных.
- Возможность восстановления данных для доказательства владения интеллектуальной собственностью.
- Использование рекомендованных механизмов обеспечения целостности данных.

## 10.2. Тонкости
- Полная подготовка к нештатной ситуации включает наличие резервных версий всего.
- Резервный сайт с резервными системами.
- В крупных компаниях используется термин «планирование резервных вариантов» или «планирование непрерывности бизнеса».

### 10.2.1. Резервный сайт
- Высокая доступность требует полного резервного сайта в другом месте.
- Возможность продублировать критические службы в двух вычислительных центрах.
- Использование резервного оборудования для восстановления служб.
- Контракты на поставку оборудования в случае чрезвычайной ситуации.
- Обозначение менее важных служб для использования их оборудования в случае необходимости.

### 10.2.2. Нарушения безопасности
- Растущая проблема нарушений безопасности.
- Анализ рисков для определения мер защиты данных.
- Способы справиться с риском: барьеры вокруг системы или мониторинг для быстрого отключения.
- Продавец должен объяснить структуру безопасности продукта и факторы риска.

### 10.2.3. Отношения с прессой
- Журналисты захотят узнать детали чрезвычайной ситуации.
- Заключение соглашения с PR-компанией заблаговременно.
- Планирование общения с прессой: кто будет общаться, что будет сказано, порядок цепочки управления.
- Подготовка всех, кто будет общаться с прессой, в PR-компании.

## 10.3. Заключение
- Понимание важных служб и временных рамок их восстановления.
- Знание возможных чрезвычайных ситуаций и их расходов.
- Аварийный план должен учитывать время на получение нового оборудования и резервных копий.
- Заблаговременное планирование для получения нужного оборудования и резервных кассет.
- Поиск простых и сложных способов ограничения ущерба.
- Подготовка плана действий людей в случае чрезвычайной ситуации.
- Полное резервирование с резервным сайтом является идеалом, но можно включить второй вычислительный центр в аварийный план с разумными расходами.
